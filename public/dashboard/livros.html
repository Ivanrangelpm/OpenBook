<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" href="../assets/icon/favicon2.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AquaTech | Tempo Real</title>


    <link rel="stylesheet" href="./../css/dashboards.css">
    <link rel="stylesheet" href="./../css/estilo.css" />
    <link rel="stylesheet" href="./../css/livros.css">

    <script src="../js/sessao.js"></script>
    <script src="../js/alerta.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
</head>
<!--onload="validarSessao()"-->
<body>

    <div class="janela">

        <div class="header-left dash-header">

            <h1>AquaTech</h1>

            <div class="hello">
                <img style="width: 50px; height: 50px; border-radius: 100%; margin-top: 10px; margin-right: 10px;" id="imgPerfil" src="https://static.vecteezy.com/ti/vetor-gratis/p1/9734564-default-avatar-profile-icon-of-social-media-user-vetor.jpg" alt="">
                <h3>Olá, <span id="b_usuario">usuário</span>!</h3>
            </div>

            <div class="btn-nav-white">
              <a href="usuario.html">
                <h3>Perfil</h3>
              </a>
                
            </div>

            <div class="btn-nav-white">
                <a href="./forum.html">
                    <h3>Fórum</h3>
                </a>
            </div>

            <div class="btn-nav-white">
                <a href="../bobia.html">
                    <h3>recomendAI</h3>
                </a>
            </div>

            <div class="btn-nav">
              <a href="./livros.html">
                  <h3>Livros</h3>
              </a>
          </div>

            <div class="btn-logout" onclick="limparSessao()">
                <h3>Sair</h3>
            </div>

        </div>

        
        <div class="containerLivros">
          Filtre o periodo: 
            <select name="" id="sel_tempo">
              <option  selected disabled value="0">Selecione um periodo de tempo</option>
              <option value="mes">Ultimo mês</option>
              <option value="semestre">Ultimo semestre</option>
              <option value="ano">Ultimo ano</option>
            </select>
            Filtre por genero
            <select name="" id="sel_genero">
              <option  selected disabled value="0">Selecione um genero</option>
              <option value="ficCientifica">Ficção Científica</option>
              <option value="terror">terror</option>              
              <option value="biografia">Biografia</option>
              <option value="aventura">Aventura</option>
              <option value="drama">drama</option>
              <option value="romance">Romance</option>
            </select>
            <button onclick="abrirCadastrarLivros()"> Cadastrar novo livro lido</button>

            <div id="divCadastrarLivros" class="cadastrarLivros">
              <h3>Cadastre seu novo livro lido</h3>
              Nome do Livro: <br> <input type="text" name="" id="inp_livroLido"> <br>
              Autor: <br><input type="text" name="" id="inp_autor"> <br>
              Genero: <br> <input type="text" name="" id="inp_genero"> <br>
              Nota: <br> <input type="text" name="" id="inp_nota"> <br>
              Data de leitura: <br> <input type="date" name="" id="inp_dtLeitura"> <br>
              Imagem: <br> <input type="text" name="" id="inp_imagem">
              <button onclick="cadastrarLivros()">Cadastrar Livro</button>
              <div id="erroLivroCadastrar"></div>
            </div>

            <div class="divContainerLivros" id="divContainerLivros">
              <div id="feedLivro1" class="containerCardLivros">

              </div>
  
              <div id="feedLivro2" class="containerCardLivros">
  
              </div> 
            </div>

        </div>

    </div>
 

</body>

<script>

    function cadastrarLivros(){
        var livroLido = inp_livroLido.value;
        var autor = inp_autor.value;
        var genero = inp_genero.value;
        var nota = Number(inp_nota.value)
        var dtLeitura = inp_dtLeitura.value;
        var fotoLivro = inp_imagem.value;
        var fkUsuario = sessionStorage.ID_USUARIO;


        if (fotoLivro == "") {
            fotoLivro = "https://img.freepik.com/vetores-premium/livro-fechado-marrom_135176-141.jpg"
        }

        if (livroLido == "" || autor == "" || genero == "" || nota == "" || dtLeitura == "") {
          erroLivroCadastrar.innerHTML = `Preencha todas as informações!`
        } else {
          erroLivroCadastrar.innerHTML = "";
            setTimeout(fecharCadastroLivro, 500);
        



        // Enviando o valor da nova input
        fetch("/livro/cadastrarLivro", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js

                nomeLivroServer: livroLido,
                autorServer: autor,
                generoServer: genero,
                notaServer: nota,
                dtLeituraServer: dtLeitura,
                fotoLivroServer: fotoLivro,
                fkUsuarioServer: fkUsuario
                
            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);

                if (resposta.ok) {

                    erroLivroCadastrar.innerHTML =
                        "";
                    //atualizarForum();
                } else {
                    throw "Houve um erro ao tentar realizar o cadastro do Forum!";
                }
            })
            .catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
            });

        return false;
        }
      function fecharCadastroLivro() {
        divCadastrarLivros.style.display = 'none';
      }

    }

     function abrirCadastrarLivros() {
      divCadastrarLivros.style.display = 'block';

     }


     

 /*
Fazer uma lista de desejos para o usuario ler no futuro


 fazer um select para filtrar os livros que leu no ultimo mes / semestre / ano 
 e outro select para genero

 inp oninput com o nome do livro
 
 inp oninput nome do autor

 nota que o usuario dá para o livro 


 select com genero dos livros


 um botao para cadastrar novos livros lidos
 
 
 a função listar livros pode encrementar 3 listas com genero autores e nomes   
 */



</script>

</html>